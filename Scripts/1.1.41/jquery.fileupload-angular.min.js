(function(n){"use strict";typeof define=="function"&&define.amd?define(["jquery","angular","./jquery.fileupload-image","./jquery.fileupload-audio","./jquery.fileupload-video","./jquery.fileupload-validate"],n):typeof exports=="object"?n(require("jquery"),require("angular"),require("./jquery.fileupload-image"),require("./jquery.fileupload-audio"),require("./jquery.fileupload-video"),require("./jquery.fileupload-validate")):n()})(function(){"use strict";angular.module("blueimp.fileupload",[]).provider("fileUpload",function(){var n=function(n){var t=angular.element(this).fileupload("option","scope");t.$evalAsync(n)},t=function(n,t){var r=t.files,i=r[0];angular.forEach(r,function(n,i){n._index=i;n.$state=function(){return t.state()};n.$processing=function(){return t.processing()};n.$progress=function(){return t.progress()};n.$response=function(){return t.response()}});i.$submit=function(){if(!i.error)return t.submit()};i.$cancel=function(){return t.abort()}},i;i=this.defaults={handleResponse:function(n,t){var i=t.result&&t.result.files;i?t.scope.replace(t.files,i):(t.errorThrown||t.textStatus==="error")&&(t.files[0].error=t.errorThrown||t.textStatus)},add:function(n,i){if(n.isDefaultPrevented())return!1;var r=i.scope,u=[];angular.forEach(i.files,function(n){u.push(n)});r.$parent.$applyAsync(function(){t(r,i);var n=r.option("prependFiles")?"unshift":"push";Array.prototype[n].apply(r.queue,i.files)});i.process(function(){return r.process(i)}).always(function(){r.$parent.$applyAsync(function(){t(r,i);r.replace(u,i.files)})}).then(function(){(r.option("autoUpload")||i.autoUpload)&&i.autoUpload!==!1&&i.submit()})},done:function(n,t){if(n.isDefaultPrevented())return!1;var i=this;t.scope.$apply(function(){t.handleResponse.call(i,n,t)})},fail:function(n,t){if(n.isDefaultPrevented())return!1;var r=this,i=t.scope;if(t.errorThrown==="abort"){i.clear(t.files);return}i.$apply(function(){t.handleResponse.call(r,n,t)})},stop:n,processstart:n,processstop:n,getNumberOfFiles:function(){var n=this.scope;return n.queue.length-n.processing()},dataType:"json",autoUpload:!1};this.$get=[function(){return{defaults:i}}]}).provider("formatFileSizeFilter",function(){var n={units:[{size:1e9,suffix:" GB"},{size:1e6,suffix:" MB"},{size:1e3,suffix:" KB"}]};this.defaults=n;this.$get=function(){return function(t){if(!angular.isNumber(t))return"";for(var i=!0,r=0,u,f;i;){if(i=n.units[r],u=i.prefix||"",f=i.suffix||"",r===n.units.length-1||t>=i.size)return u+(t/i.size).toFixed(2)+f;r+=1}}}}).controller("FileUploadController",["$scope","$element","$attrs","$window","fileUpload","$q",function(n,t,i,r,u,f){var e={progress:function(){return t.fileupload("progress")},active:function(){return t.fileupload("active")},option:function(n,i){if(arguments.length===1)return t.fileupload("option",n);t.fileupload("option",n,i)},add:function(n){return t.fileupload("add",n)},send:function(n){return t.fileupload("send",n)},process:function(n){return t.fileupload("process",n)},processing:function(n){return t.fileupload("processing",n)}};n.disabled=!r.jQuery.support.fileInput;n.queue=n.queue||[];n.clear=function(n){var i=this.queue,t=i.length,r=n,u=1;for(angular.isArray(n)&&(r=n[0],u=n.length);t;)if(t-=1,i[t]===r)return i.splice(t,u)};n.replace=function(n,t){for(var u=this.queue,f=n[0],r,i=0;i<u.length;i+=1)if(u[i]===f){for(r=0;r<t.length;r+=1)u[i+r]=t[r];return}};n.applyOnQueue=function(n){for(var r=this.queue.slice(0),i,u=[],t=0;t<r.length;t+=1)i=r[t],i[n]&&u.push(i[n]());return f.all(u)};n.submit=function(){return this.applyOnQueue("$submit")};n.cancel=function(){return this.applyOnQueue("$cancel")};angular.extend(n,e);t.fileupload(angular.extend({scope:n},u.defaults)).on("fileuploadadd",function(t,i){i.scope=n}).on("fileuploadfail",function(n,t){if(t.errorThrown!=="abort"&&t.dataType&&t.dataType.indexOf("json")===t.dataType.length-4)try{t.result=angular.fromJson(t.jqXHR.responseText)}catch(i){}}).on("fileuploadadd fileuploadsubmit fileuploadsend fileuploaddone fileuploadfail fileuploadalways fileuploadprogress fileuploadprogressall fileuploadstart fileuploadstop fileuploadchange fileuploadpaste fileuploaddrop fileuploaddragover fileuploadchunksend fileuploadchunkdone fileuploadchunkfail fileuploadchunkalways fileuploadprocessstart fileuploadprocess fileuploadprocessdone fileuploadprocessfail fileuploadprocessalways fileuploadprocessstop",function(t,i){n.$parent.$applyAsync(function(){n.$emit(t.type,i).defaultPrevented&&t.preventDefault()})}).on("remove",function(){for(var t in e)e.hasOwnProperty(t)&&delete n[t]});n.$watch(i.fileUpload,function(n){n&&t.fileupload("option",n)})}]).controller("FileUploadProgressController",["$scope","$attrs","$parse",function(n,t,i){var u=i(t.fileUploadProgress),r=function(){var t=u(n);t&&t.total&&(n.num=Math.floor(t.loaded/t.total*100))};r();n.$watch(t.fileUploadProgress+".loaded",function(n,t){n!==t&&r()})}]).controller("FileUploadPreviewController",["$scope","$element","$attrs",function(n,t,i){n.$watch(i.fileUploadPreview+".preview",function(n){t.empty();n&&t.append(n)})}]).directive("fileUpload",function(){return{controller:"FileUploadController",scope:!0}}).directive("fileUploadProgress",function(){return{controller:"FileUploadProgressController",scope:!0}}).directive("fileUploadPreview",function(){return{controller:"FileUploadPreviewController"}}).directive("download",function(){return function(n,t){t.on("dragstart",function(n){try{n.originalEvent.dataTransfer.setData("DownloadURL",["application/octet-stream",t.prop("download"),t.prop("href")].join(":"))}catch(i){}})}})})